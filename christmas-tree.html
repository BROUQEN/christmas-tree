<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Christmas tree ;3</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

        <div id="sky">
            <div id="stars_container">
                <div class="star"></div>
                <div class="star"></div>
                <div class="star"></div>
            </div>

            <div id="snowflakes_container">
                <script>

                    function createSnowflake() {
                        const snowflake = document.createElement("div");
                        snowflake.className = "snowflake";

                        let fallTime = Math.random() * 5 + 5;
                        snowflake.style.animation = `fall ${fallTime}s linear infinite`; // random time
                        
                        let windPower = parseFloat(document.getElementById("windPower").value); // Check value for wind from settings
                        snowflake.style.setProperty("--windPower", windPower + "vw"); // add wind to animation
                        
                        snowflake.style.width = snowflake.style.height = Math.random() * 5 + 5 + "px"; // random size


                        //idk what really happens in math.random. I don't know why this piece of nightmare down below even works? but it works.. yuppi? ;-;

                        //check for wind, if yes we change position of spawning snowflakes. If we dont do that then theres no snowflakes in botoom corners 

                        if(windPower == 0){
                            snowflake.style.left = Math.random() * 100 + "vw"; // random pos
                        }else if(windPower > 0){
                            snowflake.style.left = (Math.random() * (100 + windPower) - windPower) + "vw"; // random pos based on wind
                        
                        }else{
                            snowflake.style.left = Math.random() * (100 - windPower) + "vw";  //random pos based on wind
                        
                        }
                        snowflake.style.opacity = Math.random() * 0.7 + 0.3; // random opacity
                        snowflake.style.zIndex = Math.random() < 0.5 ? 1 : 10; // random z 1 or 10 back of front of the tree
                        document.body.appendChild(snowflake);

                        // Deleting snowflakes
                        setTimeout(() => {
                        snowflake.remove();
                        }, fallTime * 1000); //fixed falling time so when animation end they die ;c
                    }

                    // Initial settings
                    var snowAmount = 15;
                    var snowSpawnDelay = 1000 / snowAmount;

                    var snowSpawnInt = setInterval(createSnowflake, snowSpawnDelay);
                    console.log(snowSpawnDelay);

                </script>
            </div>

        </div>

        <div id="options" class="pane">
            <header>Options (drag here owo)</header>
        
            <div class="content">
                <p>This is a draggable options window. Will add more content here in the future. note: this window is buggy af ;c</p>


                <div class="slider_settings">
                    <div class="slider">
                        <p>Snow Amount</p>
            
                        <input type="range" min="0" max="70" value="15" class="slider" id="snowAmount">

                        <div class="value-container">
                            <span id="snowAmountInput">15/s</span>
                        </div>
                    </div>
                    
                    
                    <script>
                        let outputSnowAmount = document.getElementById("snowAmountInput");
                        let sliderSnowAmount = document.getElementById("snowAmount");
                
                        // When slider has input
                        sliderSnowAmount.oninput = function () {
                            // Update value
                            outputSnowAmount.innerHTML = this.value + "/s";
                            if(this.value == 0){
                                console.log("Snow Turned OFF");
                                clearInterval(snowSpawnInt);
                            }else{
                                snowAmount = this.value;
                                snowSpawnDelay = 1000 / snowAmount;

                                // Stop previous interval if it exists
                                clearInterval(snowSpawnInt);

                                // Start new interval with updated delay
                                snowSpawnInt = setInterval(createSnowflake, snowSpawnDelay);

                                console.log("Snoflake spawning every " + snowSpawnDelay + "ms");
                            }       
                        };

                    </script>

                </div>

                <div class="slider_settings">
                    <div class="slider">
                        <p>Wind Power</p>
            
                        <input type="range" min="-100" max="100" value="20" class="slider" id="windPower">

                        <div class="value-container">
                        <span id="windPowerInput">2vw/s</span>
                        </div>
                    </div>
                    
                    <p class="slider_description">(1vw is 1% of the viewport ;3)</p>

                    <script>
                        let outputWindAmount = document.getElementById("windPowerInput");
                        let sliderWindAmount = document.getElementById("windPower");
                
                        // When slider has input
                        sliderWindAmount.oninput = function () {
                            // Update value
                            outputWindAmount.innerHTML = this.value / 10 + "vw/s";
                            if(this.value == 0){
                                console.log("Wind Turned OFF");
                                
                            }else{
                                console.log("Wind Power set to "+this.value);
                            }       
                        };

                    </script>
                </div>
                    
            </div>
        
            
        </div>

        <script>
            const pane = document.querySelector(".pane");
            const header = pane.querySelector("header");

            let isDragging = false;
            let startX, startY, startLeft, startTop;

            function onDrag(event) {
                if (!isDragging) return;

                const movementX = event.clientX - startX;
                const movementY = event.clientY - startY;

                const newLeft = startLeft + movementX;
                const newTop = startTop + movementY;

                const maxLeft = window.innerWidth - pane.offsetWidth;
                const maxTop = window.innerHeight - pane.offsetHeight;

                const clampedLeft = Math.max(0, Math.min(newLeft, maxLeft));
                const clampedTop = Math.max(0, Math.min(newTop, maxTop));

                pane.style.left = `${clampedLeft}px`;
                pane.style.top = `${clampedTop}px`;
            }

            function onMouseDown(event) {
                isDragging = true;
                startLeft = parseInt(window.getComputedStyle(pane).left, 10);
                startTop = parseInt(window.getComputedStyle(pane).top, 10);
                startX = event.clientX;
                startY = event.clientY;

                document.addEventListener("mousemove", onDrag);
                document.addEventListener("mouseup", onMouseUp);
            }

            function onMouseUp() {
                isDragging = false;
                document.removeEventListener("mousemove", onDrag);
                document.removeEventListener("mouseup", onMouseUp);
            }

            header.addEventListener("mousedown", onMouseDown);

        </script>
          
        <div id="tree">
            <!--MAIN_STAR-->
            <div id="main_star"></div>
            <div class="star_holder"></div>
            
            <div id="layers_container">
                <!--LVL5-->
                <div id="layer5" class="layers">
                    <div class="bauble" id="bauble5">
                        <div class="bauble_top"></div>
                    </div>
                </div>
                <!--LVL4-->
                <div id="layer4" class="layers">
                    <div class="bauble" id="bauble4">
                        <div class="bauble_top"></div>
                    </div>
                </div>
                <!--LVL3-->
                <div id="layer3" class="layers">
                    <div class="bauble" id="bauble3">
                        <div class="bauble_top"></div>
                    </div>
                    <div class="trapezoid">
                        <div class="bauble_top"></div>
                    </div>
                </div>
                <!--LVL2-->
                <div id="layer2" class="layers">
                    <div class="bauble" id="bauble2">
                        <div class="bauble_top"></div>
                    </div>
                    <div class="trapezoid" id="trapezoid2">
                        <div class="trapezoid_top"></div>
                    </div>
                </div>
                <!--LVL1-->
                <div id="layer1" class="layers">
                    <div class="bauble" id="bauble12">
                        <div class="bauble_top"></div>
                    </div>
                    <div class="bauble" id="bauble1">
                        <div class="bauble_top"></div>
                    </div>
                </div>
            </div>

            <!--LOG-->
            <div id="log">
            </div>
        </div>

        <div id="ground"></div>
    
</body>

<footer></footer>

</html>
