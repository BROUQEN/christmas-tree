<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Christmas tree ;3</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

        <div id="sky">
            <div id="stars_container">
                <div class="star"></div>
                <div class="star"></div>
                <div class="star"></div>
            </div>

            <div id="snowflakes_container">
                <script>

                    function createSnowflake() {
                      const snowflake = document.createElement("div");
                      snowflake.className = "snowflake";
                      snowflake.style.left = Math.random() * 100 + "vw"; // random pos
                      snowflake.style.width = snowflake.style.height = Math.random() * 5 + 5 + "px"; // random size

                      let fallTime = Math.random() * 5 + 5;
                      snowflake.style.animation = `fall ${fallTime}s linear infinite`; // random time


                      snowflake.style.opacity = Math.random() * 0.7 + 0.3; // random opacity
                      snowflake.style.zIndex = Math.random() < 0.5 ? 1 : 10; // random z 1 or 10 back of front of the tree
                      document.body.appendChild(snowflake);

                      // Deleting snowflakes
                      setTimeout(() => {
                        snowflake.remove();
                      }, fallTime * 1000); //fixed falling time so when animation end they die ;c
                    }

                    // Initial settings
                    let snowAmount = 15;
                    let snowSpawnDelay = 1000 / snowAmount;

                    let snowSpawnInt = setInterval(createSnowflake, snowSpawnDelay);
                    console.log(snowSpawnDelay);

                </script>
            </div>

        </div>

        <div id="options" class="pane">
            <header>Options (drag here owo)</header>
        
            <div class="content">
                <p>This is a draggable options window. Will add more content here in the future. note: this window is buggy af ;c</p>


                <div class="slider_settings">
                    <p>Snow Amount</p>
            
                    <input type="range" min="0" max="70" value="15" class="slider" id="snowAmount">

                    <div class="value-container">
                        <span id="snowAmountInput">15/s</span>
                    </div>

                </div>
                    
            </div>
        
            <script>
                const output = document.getElementById("snowAmountInput");
                const slider = document.getElementById("snowAmount");
        
                // When slider has input
                slider.oninput = function () {
                    // Update value
                    output.innerHTML = this.value + "/s";
                    if(this.value == 0){
                        console.log("Snow Turned OFF");
                        clearInterval(snowSpawnInt);
                    }else{
                        snowAmount = this.value;
                        snowSpawnDelay = 1000 / snowAmount;

                        // Stop previous interval if it exists
                        clearInterval(snowSpawnInt);

                        // Start new interval with updated delay
                        snowSpawnInt = setInterval(createSnowflake, snowSpawnDelay);

                        console.log(snowSpawnDelay);
                    }
                    
                };

            </script>
        </div>

        <script>
            const pane = document.querySelector(".pane");
            const header = pane.querySelector("header");

            let isDragging = false;
            let startX, startY, startLeft, startTop;

            function onDrag(event) {
                if (!isDragging) return;

                const movementX = event.clientX - startX;
                const movementY = event.clientY - startY;

                const newLeft = startLeft + movementX;
                const newTop = startTop + movementY;

                const maxLeft = window.innerWidth - pane.offsetWidth;
                const maxTop = window.innerHeight - pane.offsetHeight;

                const clampedLeft = Math.max(0, Math.min(newLeft, maxLeft));
                const clampedTop = Math.max(0, Math.min(newTop, maxTop));

                pane.style.left = `${clampedLeft}px`;
                pane.style.top = `${clampedTop}px`;
            }

            function onMouseDown(event) {
                isDragging = true;
                startLeft = parseInt(window.getComputedStyle(pane).left, 10);
                startTop = parseInt(window.getComputedStyle(pane).top, 10);
                startX = event.clientX;
                startY = event.clientY;

                document.addEventListener("mousemove", onDrag);
                document.addEventListener("mouseup", onMouseUp);
            }

            function onMouseUp() {
                isDragging = false;
                document.removeEventListener("mousemove", onDrag);
                document.removeEventListener("mouseup", onMouseUp);
            }

            header.addEventListener("mousedown", onMouseDown);

        </script>
          
        <div id="tree">
            <!--MAIN_STAR-->
            <div id="main_star"></div>
            <div class="star_holder"></div>
            
            <div id="layers_container">
                <!--LVL5-->
                <div id="layer5" class="layers">
                    <div class="bauble" id="bauble5">
                        <div class="bauble_top"></div>
                    </div>
                </div>
                <!--LVL4-->
                <div id="layer4" class="layers">
                    <div class="bauble" id="bauble4">
                        <div class="bauble_top"></div>
                    </div>
                </div>
                <!--LVL3-->
                <div id="layer3" class="layers">
                    <div class="bauble" id="bauble3">
                        <div class="bauble_top"></div>
                    </div>
                    <div class="trapezoid">
                        <div class="bauble_top"></div>
                    </div>
                </div>
                <!--LVL2-->
                <div id="layer2" class="layers">
                    <div class="bauble" id="bauble2">
                        <div class="bauble_top"></div>
                    </div>
                    <div class="trapezoid" id="trapezoid2">
                        <div class="trapezoid_top"></div>
                    </div>
                </div>
                <!--LVL1-->
                <div id="layer1" class="layers">
                    <div class="bauble" id="bauble12">
                        <div class="bauble_top"></div>
                    </div>
                    <div class="bauble" id="bauble1">
                        <div class="bauble_top"></div>
                    </div>
                </div>
            </div>

            <!--LOG-->
            <div id="log">
            </div>
        </div>

        <div id="ground"></div>
    
</body>

<footer></footer>

</html>
